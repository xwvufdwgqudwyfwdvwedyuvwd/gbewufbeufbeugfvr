-- Script: ServerScriptService
local TARGET_USERID = 5464154339
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")

-- Gradient Colors untuk animasi teks
local gradientColors = {
    Color3.fromRGB(0, 255, 255),
    Color3.fromRGB(255, 0, 255),
    Color3.fromRGB(255, 255, 0),
    Color3.fromRGB(0, 255, 0),
}

local function attachBillboardToCharacter(player, character)
    if not character then return end
    local head = character:FindFirstChild("Head") 
                or character:FindFirstChild("UpperTorso") 
                or character:FindFirstChild("HumanoidRootPart")
    if not head then return end
    if head:FindFirstChild("DevNexaBillboard") then return end

    -- Billboard
    local billboard = Instance.new("BillboardGui")
    billboard.Name = "DevNexaBillboard"
    billboard.Adornee = head
    billboard.AlwaysOnTop = true
    billboard.ExtentsOffset = Vector3.new(0, 2, 0) -- sedikit lebih tinggi
    billboard.Size = UDim2.new(0, 200, 0, 50)
    billboard.MaxDistance = 150
    billboard.Parent = head

    -- TextLabel
    local textLabel = Instance.new("TextLabel")
    textLabel.Name = "DevNexaLabel"
    textLabel.Size = UDim2.new(1, 0, 1, 0)
    textLabel.BackgroundTransparency = 1
    textLabel.Text = "Dev Nexa"
    textLabel.Font = Enum.Font.Code
    textLabel.TextScaled = true
    textLabel.TextStrokeTransparency = 0
    textLabel.TextStrokeColor3 = Color3.fromRGB(0, 0, 0)
    textLabel.TextColor3 = gradientColors[1]
    textLabel.Parent = billboard

    -- UI Gradient Glow
    local uiGradient = Instance.new("UIGradient")
    uiGradient.Rotation = 45
    uiGradient.Color = ColorSequence.new(gradientColors)
    uiGradient.Parent = textLabel

    -- Animasi gradient sederhana
    local index = 1
    RunService.Heartbeat:Connect(function()
        if not textLabel.Parent then return end
        index = index + 0.01
        local i1 = math.floor(index) % #gradientColors + 1
        local i2 = (i1 % #gradientColors) + 1
        textLabel.TextColor3 = gradientColors[i1]:Lerp(gradientColors[i2], index % 1)
    end)
end

local function cleanupBillboard(player)
    if player and player.Character then
        local head = player.Character:FindFirstChild("Head") 
                    or player.Character:FindFirstChild("UpperTorso") 
                    or player.Character:FindFirstChild("HumanoidRootPart")
        if head then
            local b = head:FindFirstChild("DevNexaBillboard")
            if b then b:Destroy() end
        end
    end
end

local function onPlayerAdded(player)
    if player.UserId ~= TARGET_USERID then return end
    if player.Character and player.Character.Parent then
        attachBillboardToCharacter(player, player.Character)
    end
    player.CharacterAdded:Connect(function(character)
        character:WaitForChild("Humanoid", 2)
        local head = character:WaitForChild("Head", 5) 
                    or character:FindFirstChild("UpperTorso") 
                    or character:FindFirstChild("HumanoidRootPart")
        if head then
            attachBillboardToCharacter(player, character)
        end
    end)
    player.AncestryChanged:Connect(function(_, parent)
        if not parent then
            cleanupBillboard(player)
        end
    end)
end

for _, p in ipairs(Players:GetPlayers()) do
    onPlayerAdded(p)
end

Players.PlayerAdded:Connect(onPlayerAdded)
Players.PlayerRemoving:Connect(function(player)
    if player.UserId == TARGET_USERID then
        cleanupBillboard(player)
    end
end)
